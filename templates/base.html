<!DOCTYPE html>
{% load static %}
<html lang="en" data-theme="light">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}ShopperMart{% endblock %}</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Modern CSS -->
  <link rel="stylesheet" href="{% static 'css/modern.css' %}">
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="container navbar-content">
      <a class="nav-brand" href="{% url 'home' %}">ğŸ›’ ShopperMart</a>

      <button class="mobile-toggle" id="mobileToggle" aria-label="Toggle Menu">
        â˜°
      </button>

      <div class="nav-links" id="navLinks">
        <a class="nav-link" href="{% url 'home' %}">Store</a>
        <a class="nav-link" href="{% url 'cart' %}">Cart</a>
        <a class="nav-link" href="{% url 'checkout' %}">Checkout</a>
        {% if user.is_authenticated %}
        <a class="nav-link" href="{% url 'my_orders' %}">Orders</a>
        {% endif %}
      </div>

      <div class="nav-actions">
        <!-- Search Icon Toggle for Mobile could go here -->
        <button id="themeToggle" class="btn btn-outline btn-sm">
          ğŸŒ“
        </button>

        {% if user.is_authenticated %}
        <a href="{% url 'profile' %}" class="btn btn-primary btn-sm user-btn">
          {{ user.username|slice:":1"|upper }}
        </a>
        <form action="{% url 'logout' %}" method="post" style="display:inline;">
          {% csrf_token %}
          <button type="submit" class="btn btn-outline btn-sm" style="border:none; color:var(--danger)">Log Out</button>
        </form>
        {% else %}
        <a class="btn btn-outline btn-sm" href="{% url 'login' %}">Log In</a>
        <a class="btn btn-primary btn-sm" href="{% url 'register' %}">Sign Up</a>
        {% endif %}
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="container py-4">
    {% if messages %}
    <div class="messages mb-4">
      {% for message in messages %}
      <div class="card" style="padding: 1rem; border-left: 4px solid var(--primary); margin-bottom:1rem;">
        {{ message }}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    {% block content %}{% endblock %}
  </main>

  <!-- Footer -->
  <footer class="text-center py-5"
    style="color: var(--text-muted); border-top: 1px solid var(--border-color); margin-top: 4rem;">
    <div class="container">
      <p>&copy; {% now "Y" %} ShopperMart. Crafted with <span style="color:var(--danger)">â¤</span></p>
    </div>
  </footer>

  <!-- Scripts -->
  <script>
    // Mobile Menu Toggle
    const toggle = document.getElementById('mobileToggle');
    const nav = document.getElementById('navLinks');

    toggle?.addEventListener('click', () => {
      nav.classList.toggle('active');
    });

    // Dark Mode Toggle
    const themeBtn = document.getElementById("themeToggle");
    const root = document.documentElement;
    const stored = localStorage.getItem("theme") || "light";

    root.setAttribute("data-theme", stored);

    themeBtn?.addEventListener("click", () => {
      const current = root.getAttribute("data-theme");
      const next = current === "dark" ? "light" : "dark";
      root.setAttribute("data-theme", next);
      localStorage.setItem("theme", next);
    });
  </script>
</body>

</html>